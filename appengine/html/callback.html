<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='utf-8'>
  <title>Callback - GitHub Anywhere</title>
  <link rel='stylesheet' href='https://githubanywhere.appspot.com/style/style.css'>

  <script>
  var code = getUrlVariables().code;
  function getUrlVariables() {
    console.log('getUrlVariables()');
    var variables = [], hash, hashes, i, l;
    hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');
    l = hashes.length;
    for (i = 0; i < l; i++) {
      hash = hashes[i].split('=');
      variables.push(hash[0]);
      variables[hash[0]] = hash[1];
    }
    return variables;
  }
  
  function authorize(choice) {
    console.log('authorize()');
    var d = new Date();
    localStorage.setItem('time', d.getTime());
    localStorage.setItem('code', choice ? code : false);
    window.close();
  }
  </script>
</head>
<body>
  <section>
    <h1>GitHub Anywhere</h1>
    <div id='content'>
      <p>The site that opened this window would like to access your GitHub account.</p>
      <a class='github-anywhere github-anywhere-minibutton' data-user='abraham'><span onclick='authorize(true)'>Authorize site to access and update my GitHub account</span></a>
      <a class='github-anywhere github-anywhere-minibutton github-anywhere-enabled' data-user='abraham'><span onclick='authorize(false)'>Don't authorize site</span></a>
      <p>Learn more at <a href='http://abrah.am/github-anywhere'>abrah.am/github-anywhere</a>.</p>
  </section>
</body>
</html>